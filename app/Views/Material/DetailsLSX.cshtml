
@model DKAC.Models.InfoModel.DonHangInfo
@{
    ViewBag.Title = "Chi tiết";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    label {
        margin-top: 8px;
        color: #435d7d;
        font-weight: 700;
    }

    .form-group {
        border: 2px solid #afc9e4;
        background: #f9fcff;
        padding: 20px;
    }

        .form-group .row {
            margin-top: 20px;
            margin-bottom: 20px;
        }

    .table-bordered td, .table-bordered th {
        padding: 5px !important;
        vertical-align: middle !important;
    }

    svg:not(:root).svg-inline--fa {
        color: red;
    }

    .lock {
        color: black;
        background-color: white;
        border: none;
    }

    .home {
        color: #1bbd36 !important;
    }

    .inputText {
        padding: 3px !important;
        font-size: 14px !important;
    }

    .form-group {
        margin-bottom: 0;
    }


    margin-top-15 {
        margin-top: 15px !important;
    }

    .modal-header {
        background-color: #0076d2;
        color: white;
    }

    .modal-content {
        border: #d0d0d0 solid 2px !important;
        background-color: #fff7ec;
    }

    .ui-autocomplete {
        z-index: 1000;
    }


    .p-l-0 {
        padding-left: 0px !important;
    }

    .margin-top-10 {
        margin-top: 10px !important;
    }

    .margin-top-40 {
        margin-top: 25px !important
    }
</style>

<head>
    <title>Chi tiết phiếu</title>
</head>

<div class="container">
    <div class="table-wrapper">
        <div class="table-title">
            <div class="row">
                <div class="col-sm-6 uppercase">
                    <h2>XEM CHI TIẾT PHIẾU</h2>
                </div>
            </div>
        </div>
        <div class="row">
            <ol class="breadcrumb" style="margin-left: 15px;">
                <li style="margin-right: 10px"><a href="/"> <i class="fa fa-home home"></i> Home</a></li>
                <li class="active">
                    <span>Chi tiết</span>
                </li>
            </ol>
        </div>

        <form action="" method="post" id="edit">
            <div class="form-group">
                <input type="hidden" class="form-control" id="id" value="@Model.id" disabled />
                <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-8 text-center">
                        <h2><label>BẢNG LỆNH SẢN XUẤT</label></h2>
                    </div>
                    <div class="col-md-2 m-1"></div>
                </div>

                <div class="row">
                    <div class="col-md-2 text-right">
                        <label>Số LSX: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="so_lenh_sx" value="@Model.so_lenh_sx" disabled />
                        <div class="valid" style="color: red; font-style: italic;">
                            <div class="textNoti" id="textvalid">
                                <!--hiển thị thông báo-->
                            </div>
                        </div>

                    </div>

                    <div class="col-md-2 text-right">
                        <label>Ngày: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="created_date" value="@(Model.created_date.HasValue?Model.created_date.Value.ToString("dd/MM/yyyy") : "")" placeholder="dd/MM/yyyy" disabled />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2 text-right">
                        <label>Loại: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="loai" value="@Model.loai" disabled />
                    </div>

                    <div class="col-md-2 text-right">
                        <label>Lần sửa dổi: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="number" min="0" class="form-control" id="lan_dieu_chinh" value="@Model.lan_dieu_chinh" disabled />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2 text-right">
                        <label>Phiếu ĐNSX số: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="phieu_dnsx_so" value="@Model.phieu_dnsx_so" disabled />
                    </div>

                    <div class="col-md-2 text-right">
                        <label>Nhân Viên Kinh Doanh: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="nv_kinh_doanh" value="@Model.nv_kinh_doanh" disabled />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2 text-right">
                        <label>Mã khách hàng: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="ma_khach_hang" value="@Model.ma_khach_hang" disabled />
                    </div>

                    <div class="col-md-2 text-right">
                        <label>Tên khách hàng: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="ten_khach_hang" value="@Model.ten_khach_hang" disabled />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2 text-right">
                        <label>Mã sản phẩm: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="ma_san_pham" value="@Model.ma_san_pham" disabled />
                    </div>

                    <div class="col-md-2 text-right">
                        <label>Tên sản phẩm: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="ten_san_pham" value="@Model.ten_san_pham" disabled />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2 text-right">
                        <label>Nhà cung cấp vật tư: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="nha_cc" value="@Model.nha_cc" disabled />
                    </div>

                    <div class="col-md-2 text-right">
                        <label>Khổ TP: </label>
                    </div>
                    <div class="col-md-2">
                        <input type="text" class="form-control" id="kho_doc" value="@Model.kho_doc" placeholder="Dài" disabled />
                    </div>

                    <div class="col-md-2">
                        <input type="text" class="form-control" id="kho_ngang" value="@Model.kho_ngang" placeholder="Rộng" disabled />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-3"></div>
                    <div class="col-md-2 text-right">
                        <label>Ngày giao hàng: </label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="ngay_giao_hangMH3" value="@(Model.ngay_giao_hang.HasValue ? Model.ngay_giao_hang.Value.ToString("dd/MM/yyyy"): "")" placeholder="dd/MM/yyyy" disabled />
                    </div>
                    <div class="col-md-3"></div>
                </div>

                <hr />
                <!--//////////////////////////////start lệnh sản xuất/////////////////////////////-->
                <!--Bảng số lượng tổng-->
                <div class="row">
                    <div class="col-md-3"></div>
                    <div class="col-md-6 margin-top-10">
                        <div class="table-responsive" style="border: 1px solid black !important;overflow-y: hidden;overflow-x: hidden;">
                            <table class="table table-striped table-bordered info-materials" id="printTableSLTong" style="margin-bottom:0px !important">
                                <tr style="background-color: white; color: black;">
                                    <th class="text-center" style="width:30px">STT</th>
                                    <th class="text-center" style="width:250px">
                                        <div class="row">
                                            <div class="col-md-3 text-left">
                                                <label>Số lượng tổng:</label>
                                            </div>
                                            <div class="col-md-9 text-left">
                                                <input type="text" class="form-control iinteger" id="so_luong_tong" value="@Model.so_luong_tong" disabled />
                                            </div>
                                        </div>

                                    </th>
                                </tr>

                                <tbody id="appendixPrintTbodySLTong"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-3"></div>
                </div>

                <hr />

                <!--I. Quy cách sản phẩm-->
                <div class="group">
                    <div class="form-body">
                        <div class="row span">
                            <div class="col-md-3">
                                <label class="caption-subject sbold uppercase" style="font-size:20px;">
                                    <u>I. QUY CÁCH SP</u>
                                </label>
                            </div>

                            <div class="col-md-6">
                                <div class="table-responsive" style="border: 1px solid black !important;">
                                    <table class="table table-striped table-bordered" style="border: 1px solid black !important; margin-bottom: 0px" id="tableQuyCachMH3">

                                        <tbody id="appendQuyCachTbodyMH3"></tbody>

                                    </table>
                                </div>
                            </div>
                            <div class="col-md-3">
                            </div>
                        </div>
                    </div>
                </div>

                <hr />

                <!--Bảng nội dung Chế bản-->
                <div class="group">
                    <div class="form-body">
                        <div class="row span">
                            <div class="col-md-2">
                                <label class="caption-subject sbold uppercase" style="font-size:20px;">
                                    <u>II. CHẾ BẢN</u>
                                </label>
                            </div>
                        </div>

                        <div class="row span">
                            <div class="col-md-2" style="padding-top: 10px;">
                                <label>Thời gian giao file:</label>
                            </div>
                            <div class="col-md-10">
                                <input type="text" class="form-control" id="cb_thoi_gian_giao" value="@Model.cb_thoi_gian_giao" disabled />
                            </div>
                        </div>

                        <div class="row span">
                            <div class="col-md-2" style="padding-top: 10px;">
                                <label>Ghi chú đặc biệt:</label>
                            </div>
                            <div class="col-md-10">
                                <input type="text" class="form-control" id="cb_ghi_chu" value="@Model.cb_ghi_chu" disabled />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="table-responsive">
                                    <table class="table table-striped table-bordered info-materials" id="appendixTableMH3">
                                        <tr style="background-color: #0076d2; color: white;">
                                            <th class="text-center" rowspan="2" style="width:40px">STT</th>
                                            <th class="text-center" rowspan="2" style="width:250px">Tay in</th>
                                            <th class="text-center" rowspan="2" style="width:120px">Số kẽm</th>
                                            <th class="text-center" rowspan="2" style="width:120px">Số bộ</th>
                                            <th class="text-center" rowspan="2" style="width:120px">Tổng</th>
                                            <th class="text-center" rowspan="2" style="width:150px">Trang/khổ in</th>
                                            <th class="text-center" colspan="2" style="width:120px">Khổ in</th>
                                            <th class="text-center" rowspan="2" style="width:120px">Khổ kẽm</th>
                                            <th class="text-center" rowspan="2" style="width:150px">PP in</th>
                                        </tr>
                                        <tr style="background-color: #0076d2; color: white;">
                                            <th class="text-center" style="width:60px">Dài</th>
                                            <th class="text-center" style="width:60px">Rộng</th>
                                        </tr>

                                        <tbody id="appendixTbodyMH3"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <hr />

                <!--Bảng In-->
                <div class="group">
                    <div class="form-body">
                        <div class="row span">
                            <div class="col-md-2">
                                <label class="caption-subject sbold uppercase" style="font-size:20px;">
                                    <u>III. IN</u>
                                </label>
                            </div>
                        </div>

                        <div class="row span">
                            <div class="col-md-2" style="padding-top: 10px;">
                                <label>Ghi chú đặc biệt:</label>
                            </div>
                            <div class="col-md-10">
                                <input type="text" class="form-control" id="in_ghi_chu" value="@Model.in_ghi_chu" disabled />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="table-responsive">
                                    <table class="table table-striped table-bordered info-materials" id="printTable">
                                        <tr style="background-color: #0076d2; color: white;">
                                            <th class="text-center" rowspan="2" style="width:40px">STT</th>
                                            <th class="text-center" rowspan="2" style="width:160px">Tay in</th>
                                            <th class="text-center" rowspan="2" style="width:80px">Loại giấy</th>
                                            <th class="text-center" rowspan="2" style="width:60px">Định lượng</th>
                                            <th class="text-center" colspan="2" style="width:120px">Khổ giấy</th>
                                            <th class="text-center" colspan="2" style="width:120px">Khổ in</th>
                                            <th class="text-center" rowspan="2" style="width:70px">Chính</th>
                                            <th class="text-center" rowspan="2" style="width:70px">Bù in</th>
                                            <th class="text-center" rowspan="2" style="width:70px">Bù TP</th>
                                            <th class="text-center" rowspan="2" style="width:70px">Bù phát hành</th>
                                            <th class="text-center" rowspan="2" style="width:80px">Tổng</th>
                                            <th class="text-center" rowspan="2" style="width:90px">PP in</th>
                                            <th class="text-center" rowspan="2" style="width:80px">Số kg</th>
                                            <th class="text-center" rowspan="2" style="width:70px">Số lượt in quy đổi</th>
                                            <th class="text-center" rowspan="2" style="width:70px">Số lượt in thực tế</th>
                                        </tr>
                                        <tr style="background-color: #0076d2; color: white;">
                                            <th class="text-center" style="width:60px">Dài</th>
                                            <th class="text-center" style="width:60px">Rộng</th>
                                            <th class="text-center" style="width:60px">Dài</th>
                                            <th class="text-center" style="width:60px">Rộng</th>
                                        </tr>

                                        <tbody id="appendixPrintTbody"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <hr />
                <!--IV Thành phẩm-->
                <div class="group">
                    <div class="form-body">
                        <div class="row span">
                            <div class="col-md-12">
                                <label class="caption-subject sbold uppercase" style="font-size:20px;">
                                    <u>IV. THÀNH PHẨM</u>
                                </label>
                            </div>
                        </div>


                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-8">
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered">
                                <tr style="background-color: #0076d2; color: white;">
                                    <th class="text-center" colspan="4">Quy cách</th>
                                    <th class="text-center" rowspan="2" style="width: 275px">Số lượng</th>
                                    <th class="text-center" rowspan="2" style="width: 150px">Số cuốn/thùng</th>
                                    <th class="text-center" rowspan="2" style="width: 100px">Đơn vị tính</th>
                                </tr>
                                <tr style="background-color: #0076d2; color: white;">
                                    <th class="text-center" style="width: 200px">Vật tư</th>
                                    <th class="text-center" style="width: 140px">Dài</th>
                                    <th class="text-center" style="width: 140px">Rộng</th>
                                    <th class="text-center" style="width: 140px">Cao</th>
                                </tr>
                                <tr>
                                    <td class="text-center">
                                        Thùng
                                    </td> 
                                    <th class="text-center"><input class="form-control idecimal" type="text" value="@Model.tp_dai" id="tp_dai" disabled /></th>
                                    <th class="text-center"><input class="form-control idecimal" type="text" value="@Model.tp_rong" id="tp_rong" disabled /></th>
                                    <th class="text-center"><input class="form-control idecimal" type="text" value="@Model.tp_cao" id="tp_cao" disabled /></th>
                                    <th class="text-center"><input class="form-control iinteger" type="text" value="@Model.tp_soluong" id="tp_soluong" disabled /></th>
                                    <th class="text-center"><input class="form-control iinteger" type="text" value="@Model.tp_socuon_thung" id="tp_socuon_thung" disabled /></th>
                                    <td class="text-center">Thùng</td>
                                </tr>

                                <tr>
                                    <th class="text-center">
                                        <select class="form-control text-center" name="bangkeo" id="bangkeo" disabled>
                                            <option value="" disabled selected hidden>--Chọn--</option>
                                            <option value="1" @(Model.tp_vat_tu == 1 ? "selected" : "") title="Công thức tính số lượng: ((dài * 2) + ((rộng + cao) * 4) + 60)/100 * số thùng">Băng keo</option>
                                            <option value="2" @(Model.tp_vat_tu == 2 ? "selected" : "") title="Công thức tính số lượng: (dài + rộng + 40) * 2 / 100 * số thùng">Băng keo đặc biệt</option>
                                        </select>
                                    </th>
                                    <th class="text-center" colspan="3"><input disabled class="form-control" /></th>
                                    <th class="text-center"><input class="form-control iinteger" type="text" value="@Model.tp_sl_bangkeo" id="tp_sl_bangkeo" disabled /></th>
                                    <th class="text-center"><input disabled class="form-control" /></th>
                                    <td class="text-center">Mét</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-2"></div>
                </div>

                <div class="row">
                    <div class="col-md-2">
                        <label class="margin-top-40">Thành phẩm chung:</label>
                    </div>

                    <div class="col-md-10">
                        @Html.TextAreaFor(a=>a.quy_cach_chung, new Dictionary<string, object>
                              {
                                  {"class", " form-control"},
                                    {"id", "thanh_pham_chung"},
                                     { "maxlength", "2000" },
                                     { "row", "3" },
                                     { "disabled", "disabled" },
                              })
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2">
                        <label class="margin-top-40">Ghi chú đặc biệt:</label>
                    </div>
                    <div class="col-md-10">
                        @Html.TextAreaFor(a=>a.tp_ghi_chu, new Dictionary<string, object>
                              {
                                  {"class", " form-control"},
                                    {"id", "tp_ghi_chu"},
                                     { "maxlength", "2000" },
                                     { "row", "3" },
                                     { "disabled", "disabled" },
                              })
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2">
                        <label>Thời hạn giao thành phẩm:</label>
                    </div>
                    <div class="col-md-10">
                        <input type="text" class="form-control" id="tp_thoi_han" value="@Model.tp_thoi_han" disabled />
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-2">
                        <label>Người lập lệnh sản xuất:</label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="ten_can_bo_qlMH3" disabled value="@Model.ten_can_bo_ql" />
                    </div>

                    <div class="col-md-2 text-right">
                        <label>Người duyệt:</label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="ten_can_bo_ktMH3" disabled value="@Model.ten_can_bo_kt" />
                    </div>
                </div>

            </div>
        </form>

        <div class="row" style="margin-top: 15px">
            <div class="col-md-12 text-right">
                <a onclick="printKcsResult(@Model.id)" class="btn btn-success red" style="min-width: 6%;background-color: darkred;color: white"><i class="fa fa-file-pdf"></i> In</a>
                <a onclick="ExportExcel(@Model.id)" class="btn btn-success" style="min-width: 6%;color: white"><i class="fa fa-file-excel"></i> Excel</a>
                <a href="/Material" class="btn btn-primary"><i class="fa fa-arrow-left"></i> Quay lại</a>
            </div>
        </div>
    </div>
</div>

<!--Js file-->
<script src="~/assets/login/vendor/datepicker/moment.min.js"></script>
<script src="~/Scripts/bootbox.min.js"></script>
<script src="~/assets/vendor/jquery/1.7.1/jquery.min.js"></script>
<script src="~/Scripts/JSLINQ-vsdoc.js"></script>
<script src="~/Scripts/JSLINQ.js"></script>
@section scripts {
    <script src="~/Scripts/input-mask/jquery.inputmask.js"></script>
    <script src="~/Scripts/TPlugin/TPlugin.js"></script>
    <script type="text/javascript">

        var lstMaterialType = @Html.Raw(Json.Encode(Model.lstMaterialType));
        var lstAppendix = @Html.Raw(Json.Encode(Model.lstVatTus));
        var lstAppendixMH2 = @Html.Raw(Json.Encode(Model.lstChiTietDuToans));
        var lstAppendixMH3 = @Html.Raw(Json.Encode(Model.lstChiTietCheBans));
        var lstAppendixPrint = @Html.Raw(Json.Encode(Model.lstChiTietIns));
        var lstAppenSLTong = @Html.Raw(Json.Encode(Model.lst_sl_tong));
        var lstlstPPIn = @Html.Raw(Json.Encode(Model.lstPPIn));
        var lstKhoKem = @Html.Raw(Json.Encode(Model.lstkhoKem));

        $(document).ready(function () {

            var htmlSLTong = generateHtmlAppendSoLuongTong(lstAppenSLTong);
            $('#appendixPrintTbodySLTong').html(htmlSLTong);

            //fill bảng quy cách
            var lstQuyCach = [];
            var lstQuyCachBia = [];
            var lstQuyCachRuot = [];
            var lstQuyCachThuong = [];
            var lstTemp = lstAppendix;
            for (var i = 0; i < lstTemp.length; i++) {
                if (lstTemp[i].ten_nhom_vat_tu != null && lstTemp[i].ten_nhom_vat_tu.trim().toLowerCase().startsWith("bìa")) {
                    lstQuyCachBia.push(lstTemp[i]);
                }
                else if (lstTemp[i].ten_nhom_vat_tu != null && lstTemp[i].ten_nhom_vat_tu.trim().toLowerCase().startsWith("ruột")) {
                    lstQuyCachRuot.push(lstTemp[i]);
                }
                else { lstQuyCachThuong.push(lstTemp[i]) }
            }
            // bìa
            var quycachBiaConvert = JSLINQ(lstQuyCachBia).OrderBy(function (item) { return item.ten_nhom_vat_tu; }).Distinct(function (item) { return item.nhom_vat_tu_id; }).ToArray();
            for (var j = 0; j < quycachBiaConvert.length; j++) {
                var quycachbia = JSLINQ(lstQuyCachBia).Where(function (item) { return item.nhom_vat_tu_id == quycachBiaConvert[j]; }).ToArray();
                var htmlQuyCachBia = generateHtmlQuyCachRowMH3(quycachbia);
                $("#tableQuyCachMH3 #appendQuyCachTbodyMH3").append(htmlQuyCachBia);
            }
            // ruột
            var quycachRuotConvert = JSLINQ(lstQuyCachRuot).OrderBy(function (item) { return item.ten_nhom_vat_tu; }).Distinct(function (item) { return item.nhom_vat_tu_id; }).ToArray();
            for (var j = 0; j < quycachRuotConvert.length; j++) {
                var quycachruot = JSLINQ(lstQuyCachRuot).Where(function (item) { return item.nhom_vat_tu_id == quycachRuotConvert[j]; }).ToArray();
                var htmlQuyCachRuot = generateHtmlQuyCachRowMH3(quycachruot);
                $("#tableQuyCachMH3 #appendQuyCachTbodyMH3").append(htmlQuyCachRuot);
            }
            // thường
            var quycachThuongConvert = JSLINQ(lstQuyCachThuong).OrderByDescending(function (item) { return item.ten_nhom_vat_tu; }).Distinct(function (item) { return item.nhom_vat_tu_id; }).ToArray();
            for (var j = 0; j < quycachThuongConvert.length; j++) {
                var quycachthuong = JSLINQ(lstQuyCachThuong).Where(function (item) { return item.nhom_vat_tu_id == quycachThuongConvert[j]; }).ToArray();
                var htmlQuyCachThuong = generateHtmlQuyCachRowMH3(quycachthuong);
                $("#tableQuyCachMH3 #appendQuyCachTbodyMH3").append(htmlQuyCachThuong);
            }

            var htmlCheBan = generateHtmlAppendixMH3(lstAppendixMH3);
            $('#appendixTbodyMH3').html(htmlCheBan);

            var htmlIn = generateHtmlAppendixPrint(lstAppendixPrint);
            $('#appendixPrintTbody').html(htmlIn);

            $(".idecimal").decimalMask(2);
            $(".iinteger").decimalMask(0);
        });

        /////////tự fill bảng SL Tổng LSX///////////////
        function generateHtmlAppendSoLuongTong(lstAppenSLTong) {
            var htmlAllRows = '';
            for (var i = 0; i < lstAppenSLTong.length; i++) {
                htmlAllRows = htmlAllRows + generateHtmlAppendSLTongRow(lstAppenSLTong[i], i);
            }
            return htmlAllRows;
        }

        function generateHtmlAppendSLTongRow(appendix, index) {
            return `<tr id="standard_${index + 1}" class="appendixRow">
                            <td id="STT" class="text-center">${index + 1}</td>
                            <td>
                                <input type="text" disabled class="form-control inputText Values" value="${appendix.Values == null ? '' : appendix.Values}" />
                            </td>
                        </tr>`
        }
        /////////Kết thúc bảng SL Tổng LSX///////////////


        //////////////////tự fill bảng Quy cách sản phẩm//////////////////
        function generateHtmlQuyCachRowMH3(appendix) {
            return `<tr class="bg-blue" style="background-color: #e9ecef;color: black;">
                            <th class="text-center wrapper" style="width: 200px;vertical-align: middle;border: black solid 1px !important;">
                                ${(appendix[0].ten_nhom_vat_tu == null ? "" : appendix[0].ten_nhom_vat_tu)}
                            </th>
                            <td class="wrapper" style="padding: 0px !important;border: black solid 1px !important;">
                                ${generateDetaislQuyCachMH3(appendix)}
                            </td>
                    </tr>`
        }

        function generateDetaislQuyCachMH3(appendix) {
            var htmlRow = ``;
            for (var i = 0; i < appendix.length; i++) {
                var contentHtml = `${appendix[i].ten == null ? '' : appendix[i].ten}: ${appendix[i].trang == null ? '' : appendix[i].trang} trang ${appendix[i].loai_giay == null ? '' : appendix[i].loai_giay} ${appendix[i].dinh_luong_giay == null ? '' : appendix[i].dinh_luong_giay} In ${appendix[i].kieu_in_1 == null ? '' : appendix[i].kieu_in_1 + `/`}${appendix[i].kieu_in_2 == null ? '' : appendix[i].kieu_in_2}`
                htmlRow += `<table class="table table-striped table-bordered" style="margin-bottom: 0px !important">
                                <tbody>
                                    <tr class="wrapper">
                                        <td class="wrapper">${contentHtml}</td>
                                    </tr>
                                </tbody>
                            </table>`;
            }
            htmlRow += ``
            return htmlRow;
        }
        /////////////////////Kết thúc bảng Quy cách sản phẩm//////////////////

        ////////tự fill bảng chế phẩm LXS ///////////////////
        function generateHtmlAppendixMH3(lstAppendix) {
            var htmlAllRows = '';
            for (var i = 0; i < lstAppendix.length; i++) {
                htmlAllRows = htmlAllRows + generateHtmlAppendixRowMH3(lstAppendix[i], i);
            }
            return htmlAllRows;
        }

        function generateKhoKem(appendix, index) {
            var htmlRow = `<select class="form-control kho_kem1" required style="width: 100%" id="khokem1_${index + 1}" disabled>`;
            htmlRow += `<option value="" ${appendix.kho_kem == '' ? 'selected' : ''}>---Chọn---</option > `;
            for (var i = 0; i < lstKhoKem.length; i++) {
                htmlRow += `<option value = "${lstKhoKem[i].id}" ${lstKhoKem[i].id == appendix.kho_kem ? 'selected' : ''}> ${lstKhoKem[i].value}</option> `;
            }
            htmlRow += `</select>`
            return htmlRow;
        }

        function generatePPInCheBan(appendix, index) {
            var htmlRow = `<select class="form-control phuong_phap_in1" required style="width: 100%" id="phuongphapin1_${index + 1}" disabled>`;
            htmlRow += `<option value="" ${appendix.phuong_phap_in == '' ? 'selected' : ''}>-Chọn-</option > `;
            for (var i = 0; i < lstlstPPIn.length; i++) {
                htmlRow += `<option value = "${lstlstPPIn[i].id}" ${lstlstPPIn[i].id == appendix.phuong_phap_in ? 'selected' : ''}> ${lstlstPPIn[i].Name.trim()}</option> `;
            }
            htmlRow += `</select>`
            return htmlRow;
        }

        function generateHtmlAppendixRowMH3(appendix, index) {
            return `<tr id="standard_${index + 1}" class="appendixRow">
                            <td id="STT" class="text-center">${index + 1}</td>
                             <td>
                                <input type="text" class="form-control inputText ten_tay_in1" disabled value="${appendix.ten_tay_in == null ? '' : appendix.ten_tay_in}" id="tentayin1_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" class="form-control iinteger inputText so_kem1" disabled value="${appendix.so_kem == null ? '' : appendix.so_kem}" id="sokem1_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" class="form-control iinteger inputText so_bo1" disabled value="${appendix.so_bo == null ? '' : appendix.so_bo}" id="sobo1_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" class="form-control iinteger inputText tong1" disabled value="${appendix.tong == null ? '' : appendix.tong}" id="tong1_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" class="form-control iinteger inputText trang1" disabled value="${appendix.trang == null ? '' : appendix.trang}" id="trang1_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" class="form-control idecimal inputText kho_in_dai1" disabled value="${appendix.kho_in_dai == null ? '' : appendix.kho_in_dai}" id="khoindai1_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" class="form-control idecimal inputText kho_in_rong1" disabled value="${appendix.kho_in_rong == null ? '' : appendix.kho_in_rong}" id="khoinrong1_${index + 1}"/>
                            </td>
                            <td>
                                ${generateKhoKem(appendix, index)}
                            </td>
                            <td>
                                ${generatePPInCheBan(appendix, index)}
                            </td>
                        </tr>`
        }
        ////////kết thúc bảng chế phẩm LXS ///////////////////

        ////////////////////tự fill bảng in LSX///////////////////
        function generateHtmlAppendixPrint(lstAppendixPrint) {
            var htmlAllRows = '';
            for (var i = 0; i < lstAppendixPrint.length; i++) {
                htmlAllRows = htmlAllRows + generateHtmlAppendixPrintRow(lstAppendixPrint[i], i);
            }
            return htmlAllRows;
        }

        function generatePPInPrint(appendix, index) {
            var htmlRow = `<select class="form-control phuong_phap_in" required style="width: 100%" id="phuongphapin_${index + 1}" disabled>`;
            htmlRow += `<option value="" ${appendix.phuong_phap_in == '' ? 'selected' : ''}>-Chọn-</option > `;
            for (var i = 0; i < lstlstPPIn.length; i++) {
                htmlRow += `<option value = "${lstlstPPIn[i].id}" ${lstlstPPIn[i].id == appendix.phuong_phap_in ? 'selected' : ''}> ${lstlstPPIn[i].Name.trim()}</option> `;
            }
            htmlRow += `</select>`
            return htmlRow;
        }

        function generateHtmlAppendixPrintRow(appendix, index) {
            return `<tr id="standard_${index + 1}" class="appendixRow">
                            <td id="STT" class="text-center">${index + 1}</td>
                            <td>
                                <input type="text" disabled class="form-control inputText ten_tay_in" value="${appendix.ten_tay_in == null ? '' : appendix.ten_tay_in}" id="tentayin_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control inputText ten_loai" value="${appendix.ten_loai == null ? '' : appendix.ten_loai}" id="tenloai_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control idecimal inputText dinh_luong_giay_in" value="${appendix.dinh_luong_giay_in == null ? '' : appendix.dinh_luong_giay_in}" id="dinhluonggiayin_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control idecimal inputText kho_giay_dai" value="${appendix.kho_giay_dai == null ? '' : appendix.kho_giay_dai}" id="khogiaydai_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control idecimal inputText kho_giay_rong" value="${appendix.kho_giay_rong == null ? '' : appendix.kho_giay_rong}" id="khogiayrong_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control idecimal inputText kho_in_dai" value="${appendix.kho_in_dai == null ? '' : appendix.kho_in_dai}" id="khoindai_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control idecimal  inputText kho_in_rong" value="${appendix.kho_in_rong == null ? '' : appendix.kho_in_rong}" id="khoinrong_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control iinteger inputText chinh"  onchange="AutoFillTongIn(this)" value="${appendix.chinh == null ? '' : appendix.chinh}" id="chinh_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control iinteger inputText bu_in" onchange="AutoFillTongIn(this)" value="${appendix.bu_in == null ? '' : appendix.bu_in}" id="buin_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control iinteger inputText bu_thanh_pham" onchange="AutoFillTongIn(this)" value="${appendix.bu_thanh_pham == null ? '' : appendix.bu_thanh_pham}" id="buthanhpham_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control iinteger inputText bu_phat_hanh" onchange="AutoFillTongIn(this)" value="${appendix.bu_phat_hanh == null ? '' : appendix.bu_phat_hanh}" id="buphathanh_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control iinteger inputText sl_tong" value="${appendix.sl_tong == null ? '' : appendix.sl_tong}" id="sltong_${index + 1}"/>
                            </td>
                            <td>
                                ${generatePPInPrint(appendix, index)}
                            </td>
                            <td>
                                <input type="text" disabled class="form-control idecimal inputText so_kg" value="${appendix.so_kg == null ? '' : appendix.so_kg}" id="sokg_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control iinteger inputText so_luot_in_quy_doi" value="${appendix.so_luot_in_quy_doi == null ? '' : appendix.so_luot_in_quy_doi}" id="soluotinquydoi_${index + 1}"/>
                            </td>
                            <td>
                                <input type="text" disabled class="form-control iinteger inputText so_luot_in_thuc_te" value="${appendix.so_luot_in_thuc_te == null ? '' : appendix.so_luot_in_thuc_te}" id="soluotinthucte_${index + 1}"/>
                            </td>
                        </tr>`
        }
        ////////////////////kết thúc bảng in LSX///////////////////

        function ExportExcel(id) {
            window.location.href = '/Report/ExportExcelBangLSX?id=' + id + '&exportExcel=true';
        }

        function printKcsResult(id) {
            viewReportInNewWindow('/Report/ExportExcelBangLSX?id=' + id + '&exportExcel=false#view=FitH');
        }

        function viewReportInNewWindow(url) {
            var params = [
                'left=0',
                'top=0',
                'height=' + window.outerHeight,
                'width=' + window.outerWidth,
                'fullscreen=yes' // only works in IE, but here for completeness
            ].join(',');
            console.log(params);
            var randomnumber = Math.floor((Math.random() * 100) + 1);
            var popup = window.open(url, "_blank", 'popup_window', randomnumber, params);
        }

    </script>
}
